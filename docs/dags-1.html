<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 4 DAGs | Data Analysis with R for Social Scientists</title>
  <meta name="description" content="In this course, you will learn how to analyse data using regression in R." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content=" 4 DAGs | Data Analysis with R for Social Scientists" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="In this course, you will learn how to analyse data using regression in R." />
  <meta name="github-repo" content="jaspertjaden/DataAnalysisR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 4 DAGs | Data Analysis with R for Social Scientists" />
  
  <meta name="twitter:description" content="In this course, you will learn how to analyse data using regression in R." />
  

<meta name="author" content="Jakob Tures &amp; Jasper Tjaden" />


<meta name="date" content="2023-10-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="eda-2.html"/>
<link rel="next" href="lin-t-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About the Authors</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#github-repo"><i class="fa fa-check"></i>GitHub Repo</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro-sem.html"><a href="intro-sem.html"><i class="fa fa-check"></i><b>1</b> Introduction to Seminar</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-sem.html"><a href="intro-sem.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="eda-1.html"><a href="eda-1.html"><i class="fa fa-check"></i><b>2</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="eda-1.html"><a href="eda-1.html#objectives"><i class="fa fa-check"></i><b>2.1</b> Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="eda-1.html"><a href="eda-1.html#r-functions-covered-this-week"><i class="fa fa-check"></i><b>2.2</b> R functions covered this week</a></li>
<li class="chapter" data-level="2.3" data-path="eda-1.html"><a href="eda-1.html#what-is-eda-and-why-is-it-so-important"><i class="fa fa-check"></i><b>2.3</b> What is <em>EDA</em> and why is it so important?</a></li>
<li class="chapter" data-level="2.4" data-path="eda-1.html"><a href="eda-1.html#importing-data-into-r"><i class="fa fa-check"></i><b>2.4</b> Importing data into R</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="eda-1.html"><a href="eda-1.html#merge-datasets"><i class="fa fa-check"></i><b>2.4.1</b> Merge datasets</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="eda-1.html"><a href="eda-1.html#clean-dataset"><i class="fa fa-check"></i><b>2.5</b> Clean dataset</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="eda-1.html"><a href="eda-1.html#mutating-variables"><i class="fa fa-check"></i><b>2.5.1</b> Mutating variables</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="eda-1.html"><a href="eda-1.html#explore-the-complete-dataset"><i class="fa fa-check"></i><b>2.6</b> Explore the complete dataset</a></li>
<li class="chapter" data-level="2.7" data-path="eda-1.html"><a href="eda-1.html#explore-individual-variables"><i class="fa fa-check"></i><b>2.7</b> Explore individual variables</a></li>
<li class="chapter" data-level="2.8" data-path="eda-1.html"><a href="eda-1.html#moving-on"><i class="fa fa-check"></i><b>2.8</b> Moving on</a></li>
<li class="chapter" data-level="2.9" data-path="eda-1.html"><a href="eda-1.html#further-resources"><i class="fa fa-check"></i><b>2.9</b> Further resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="eda-2.html"><a href="eda-2.html"><i class="fa fa-check"></i><b>3</b> Exploratory Data Analysis - Exercise</a>
<ul>
<li class="chapter" data-level="3.1" data-path="eda-2.html"><a href="eda-2.html#what-is-r-markdown"><i class="fa fa-check"></i><b>3.1</b> What is R Markdown?</a></li>
<li class="chapter" data-level="3.2" data-path="eda-2.html"><a href="eda-2.html#creating-a-r-markdown-file"><i class="fa fa-check"></i><b>3.2</b> Creating a R Markdown file</a></li>
<li class="chapter" data-level="3.3" data-path="eda-2.html"><a href="eda-2.html#writing-in-r-markdown"><i class="fa fa-check"></i><b>3.3</b> Writing in R Markdown</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="eda-2.html"><a href="eda-2.html#document-components"><i class="fa fa-check"></i><b>3.3.1</b> Document components</a></li>
<li class="chapter" data-level="3.3.2" data-path="eda-2.html"><a href="eda-2.html#formatting"><i class="fa fa-check"></i><b>3.3.2</b> Formatting</a></li>
<li class="chapter" data-level="3.3.3" data-path="eda-2.html"><a href="eda-2.html#code-chunks"><i class="fa fa-check"></i><b>3.3.3</b> Code chunks</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="eda-2.html"><a href="eda-2.html#further-resources-1"><i class="fa fa-check"></i><b>3.4</b> Further resources</a></li>
<li class="chapter" data-level="3.5" data-path="eda-2.html"><a href="eda-2.html#eda---exercise"><i class="fa fa-check"></i><b>3.5</b> EDA - Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dags-1.html"><a href="dags-1.html"><i class="fa fa-check"></i><b>4</b> DAGs</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dags-1.html"><a href="dags-1.html#objectives-1"><i class="fa fa-check"></i><b>4.1</b> Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="dags-1.html"><a href="dags-1.html#functions-covered"><i class="fa fa-check"></i><b>4.2</b> Functions Covered</a></li>
<li class="chapter" data-level="4.3" data-path="dags-1.html"><a href="dags-1.html#modelling"><i class="fa fa-check"></i><b>4.3</b> Modelling</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="dags-1.html"><a href="dags-1.html#what-is-modelling"><i class="fa fa-check"></i><b>4.3.1</b> What is modelling?</a></li>
<li class="chapter" data-level="4.3.2" data-path="dags-1.html"><a href="dags-1.html#estimating-effects-vs.-prediction"><i class="fa fa-check"></i><b>4.3.2</b> Estimating effects vs. prediction</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="dags-1.html"><a href="dags-1.html#dags"><i class="fa fa-check"></i><b>4.4</b> DAGs</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="dags-1.html"><a href="dags-1.html#directed-acyclical-graphs"><i class="fa fa-check"></i><b>4.4.1</b> Directed acyclical graphs</a></li>
<li class="chapter" data-level="4.4.2" data-path="dags-1.html"><a href="dags-1.html#patterns-of-relationships"><i class="fa fa-check"></i><b>4.4.2</b> Patterns of relationships</a></li>
<li class="chapter" data-level="4.4.3" data-path="dags-1.html"><a href="dags-1.html#adjustment-set"><i class="fa fa-check"></i><b>4.4.3</b> Adjustment set</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="dags-1.html"><a href="dags-1.html#nba-dag"><i class="fa fa-check"></i><b>4.5</b> NBA DAG</a></li>
<li class="chapter" data-level="4.6" data-path="dags-1.html"><a href="dags-1.html#resources"><i class="fa fa-check"></i><b>4.6</b> Resources</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="dags-1.html"><a href="dags-1.html#dagitty.net"><i class="fa fa-check"></i><b>4.6.1</b> dagitty.net</a></li>
<li class="chapter" data-level="4.6.2" data-path="dags-1.html"><a href="dags-1.html#how-to-use-dagitty"><i class="fa fa-check"></i><b>4.6.2</b> How to use dagitty()</a></li>
<li class="chapter" data-level="4.6.3" data-path="dags-1.html"><a href="dags-1.html#more-on-dags"><i class="fa fa-check"></i><b>4.6.3</b> More on DAGs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lin-t-1.html"><a href="lin-t-1.html"><i class="fa fa-check"></i><b>5</b> Linear Regression - Theory I: Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lin-t-1.html"><a href="lin-t-1.html#objectives-2"><i class="fa fa-check"></i><b>5.1</b> Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="lin-t-1.html"><a href="lin-t-1.html#what-is-linear-regression"><i class="fa fa-check"></i><b>5.2</b> What is Linear Regression</a></li>
<li class="chapter" data-level="5.3" data-path="lin-t-1.html"><a href="lin-t-1.html#examplary-research-question-data"><i class="fa fa-check"></i><b>5.3</b> Examplary research question &amp; data</a></li>
<li class="chapter" data-level="5.4" data-path="lin-t-1.html"><a href="lin-t-1.html#simple-linear-regression"><i class="fa fa-check"></i><b>5.4</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="lin-t-1.html"><a href="lin-t-1.html#regression-formula"><i class="fa fa-check"></i><b>5.4.1</b> Regression Formula</a></li>
<li class="chapter" data-level="5.4.2" data-path="lin-t-1.html"><a href="lin-t-1.html#regressing-grade-on-hours"><i class="fa fa-check"></i><b>5.4.2</b> Regressing <code>grade</code> on <code>hours</code></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="lin-t-1.html"><a href="lin-t-1.html#moving-on-1"><i class="fa fa-check"></i><b>5.5</b> Moving on</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lin-t-2.html"><a href="lin-t-2.html"><i class="fa fa-check"></i><b>6</b> Linear Regression - Theory II: Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lin-t-2.html"><a href="lin-t-2.html#objectives-3"><i class="fa fa-check"></i><b>6.1</b> Objectives</a></li>
<li class="chapter" data-level="6.2" data-path="lin-t-2.html"><a href="lin-t-2.html#multiple-linear-regression"><i class="fa fa-check"></i><b>6.2</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="lin-t-2.html"><a href="lin-t-2.html#adding-additional-metric-variables"><i class="fa fa-check"></i><b>6.2.1</b> Adding additional metric variables</a></li>
<li class="chapter" data-level="6.2.2" data-path="lin-t-2.html"><a href="lin-t-2.html#adding-dummy-variables"><i class="fa fa-check"></i><b>6.2.2</b> Adding dummy variables</a></li>
<li class="chapter" data-level="6.2.3" data-path="lin-t-2.html"><a href="lin-t-2.html#adding-categorical-variables"><i class="fa fa-check"></i><b>6.2.3</b> Adding categorical variables</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lin-t-2.html"><a href="lin-t-2.html#returning-to-our-research-question"><i class="fa fa-check"></i><b>6.3</b> Returning to our research question</a></li>
<li class="chapter" data-level="6.4" data-path="lin-t-2.html"><a href="lin-t-2.html#adressing-the-uncertainty"><i class="fa fa-check"></i><b>6.4</b> Adressing the uncertainty</a></li>
<li class="chapter" data-level="6.5" data-path="lin-t-2.html"><a href="lin-t-2.html#moving-on-2"><i class="fa fa-check"></i><b>6.5</b> Moving on</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lin-t-3.html"><a href="lin-t-3.html"><i class="fa fa-check"></i><b>7</b> Linear Regression - Theory III: Diagnostics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="lin-t-3.html"><a href="lin-t-3.html#objectives-4"><i class="fa fa-check"></i><b>7.1</b> Objectives</a></li>
<li class="chapter" data-level="7.2" data-path="lin-t-3.html"><a href="lin-t-3.html#model-fit"><i class="fa fa-check"></i><b>7.2</b> Model fit</a></li>
<li class="chapter" data-level="7.3" data-path="lin-t-3.html"><a href="lin-t-3.html#regression-diagnostics"><i class="fa fa-check"></i><b>7.3</b> Regression diagnostics</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="lin-t-3.html"><a href="lin-t-3.html#linearity"><i class="fa fa-check"></i><b>7.3.1</b> Linearity</a></li>
<li class="chapter" data-level="7.3.2" data-path="lin-t-3.html"><a href="lin-t-3.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>7.3.2</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="7.3.3" data-path="lin-t-3.html"><a href="lin-t-3.html#homoscedasticity"><i class="fa fa-check"></i><b>7.3.3</b> Homoscedasticity</a></li>
<li class="chapter" data-level="7.3.4" data-path="lin-t-3.html"><a href="lin-t-3.html#no-overly-influential-data-points"><i class="fa fa-check"></i><b>7.3.4</b> No overly influential data points</a></li>
<li class="chapter" data-level="7.3.5" data-path="lin-t-3.html"><a href="lin-t-3.html#no-multicollinearity"><i class="fa fa-check"></i><b>7.3.5</b> No (multi)collinearity</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="lin-t-3.html"><a href="lin-t-3.html#returning-to-our-research-question-1"><i class="fa fa-check"></i><b>7.4</b> Returning to our research question</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="lin-t-3.html"><a href="lin-t-3.html#interactions"><i class="fa fa-check"></i><b>7.4.1</b> Interactions</a></li>
<li class="chapter" data-level="7.4.2" data-path="lin-t-3.html"><a href="lin-t-3.html#regression-diagnostics-revisited"><i class="fa fa-check"></i><b>7.4.2</b> Regression diagnostics (revisited)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="lin-t-3.html"><a href="lin-t-3.html#conclusion"><i class="fa fa-check"></i><b>7.5</b> Conclusion</a></li>
<li class="chapter" data-level="7.6" data-path="lin-t-3.html"><a href="lin-t-3.html#resources-1"><i class="fa fa-check"></i><b>7.6</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lin-a.html"><a href="lin-a.html"><i class="fa fa-check"></i><b>8</b> Linear Regression - Application</a>
<ul>
<li class="chapter" data-level="8.1" data-path="lin-a.html"><a href="lin-a.html#objectives-5"><i class="fa fa-check"></i><b>8.1</b> Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="lin-a.html"><a href="lin-a.html#r-functions-covered-this-week-1"><i class="fa fa-check"></i><b>8.2</b> R functions covered this week</a></li>
<li class="chapter" data-level="8.3" data-path="lin-a.html"><a href="lin-a.html#research-question"><i class="fa fa-check"></i><b>8.3</b> Research question</a></li>
<li class="chapter" data-level="8.4" data-path="lin-a.html"><a href="lin-a.html#simple-linear-regression-in-r"><i class="fa fa-check"></i><b>8.4</b> Simple linear regression in R</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="lin-a.html"><a href="lin-a.html#interpretation"><i class="fa fa-check"></i><b>8.4.1</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="lin-a.html"><a href="lin-a.html#multiple-linear-regression-in-r"><i class="fa fa-check"></i><b>8.5</b> Multiple linear regression in R</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="lin-a.html"><a href="lin-a.html#interpretation-1"><i class="fa fa-check"></i><b>8.5.1</b> Interpretation</a></li>
<li class="chapter" data-level="8.5.2" data-path="lin-a.html"><a href="lin-a.html#sidenote-adding-interactions"><i class="fa fa-check"></i><b>8.5.2</b> Sidenote: Adding interactions</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="lin-a.html"><a href="lin-a.html#regression-diagnostics-1"><i class="fa fa-check"></i><b>8.6</b> Regression Diagnostics</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="lin-a.html"><a href="lin-a.html#skewed-outcome-variable"><i class="fa fa-check"></i><b>8.6.1</b> Skewed outcome variable</a></li>
<li class="chapter" data-level="8.6.2" data-path="lin-a.html"><a href="lin-a.html#non-linearity"><i class="fa fa-check"></i><b>8.6.2</b> Non-linearity</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="lin-a.html"><a href="lin-a.html#returning-to-our-research-question-2"><i class="fa fa-check"></i><b>8.7</b> Returning to our research question</a></li>
<li class="chapter" data-level="8.8" data-path="lin-a.html"><a href="lin-a.html#moving-on-3"><i class="fa fa-check"></i><b>8.8</b> Moving on</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="lin-e.html"><a href="lin-e.html"><i class="fa fa-check"></i><b>9</b> Linear Regression - Exercise</a>
<ul>
<li class="chapter" data-level="9.1" data-path="lin-e.html"><a href="lin-e.html#linear-regression---exercise"><i class="fa fa-check"></i><b>9.1</b> Linear Regression - Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pm-t.html"><a href="pm-t.html"><i class="fa fa-check"></i><b>10</b> Prediction</a>
<ul>
<li class="chapter" data-level="10.1" data-path="pm-t.html"><a href="pm-t.html#objectives-6"><i class="fa fa-check"></i><b>10.1</b> Objectives</a></li>
<li class="chapter" data-level="10.2" data-path="pm-t.html"><a href="pm-t.html#r-functions-covered-this-week-2"><i class="fa fa-check"></i><b>10.2</b> R functions covered this week</a></li>
<li class="chapter" data-level="10.3" data-path="pm-t.html"><a href="pm-t.html#making-predictions"><i class="fa fa-check"></i><b>10.3</b> Making predictions</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="pm-t.html"><a href="pm-t.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>10.3.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="10.3.2" data-path="pm-t.html"><a href="pm-t.html#why-predict-at-all"><i class="fa fa-check"></i><b>10.3.2</b> Why predict at all?</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="pm-t.html"><a href="pm-t.html#making-better-predictions"><i class="fa fa-check"></i><b>10.4</b> Making better predictions</a></li>
<li class="chapter" data-level="10.5" data-path="pm-t.html"><a href="pm-t.html#making-even-better-predictions"><i class="fa fa-check"></i><b>10.5</b> Making even better predictions?</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="pm-t.html"><a href="pm-t.html#comparing-models"><i class="fa fa-check"></i><b>10.5.1</b> Comparing models</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="pm-t.html"><a href="pm-t.html#predicting-hypotheticals"><i class="fa fa-check"></i><b>10.6</b> Predicting hypotheticals</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="pm-t.html"><a href="pm-t.html#adressing-uncertainty"><i class="fa fa-check"></i><b>10.6.1</b> Adressing uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="pm-t.html"><a href="pm-t.html#further-resources-2"><i class="fa fa-check"></i><b>10.7</b> Further resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ml.html"><a href="ml.html"><i class="fa fa-check"></i><b>11</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ml.html"><a href="ml.html#objectives-7"><i class="fa fa-check"></i><b>11.1</b> Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="ml.html"><a href="ml.html#r-functions-covered-this-week-3"><i class="fa fa-check"></i><b>11.2</b> R functions covered this week</a></li>
<li class="chapter" data-level="11.3" data-path="ml.html"><a href="ml.html#intro-to-machine-learning"><i class="fa fa-check"></i><b>11.3</b> Intro to Machine Learning</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="ml.html"><a href="ml.html#training--and-testset"><i class="fa fa-check"></i><b>11.3.1</b> Training- and testset</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ml.html"><a href="ml.html#our-baseline-model"><i class="fa fa-check"></i><b>11.4</b> Our baseline model</a></li>
<li class="chapter" data-level="11.5" data-path="ml.html"><a href="ml.html#setting-up-tidymodels"><i class="fa fa-check"></i><b>11.5</b> Setting up tidymodels</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="ml.html"><a href="ml.html#splitting-the-data"><i class="fa fa-check"></i><b>11.5.1</b> Splitting the data</a></li>
<li class="chapter" data-level="11.5.2" data-path="ml.html"><a href="ml.html#defining-the-recipe"><i class="fa fa-check"></i><b>11.5.2</b> Defining the recipe</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="ml.html"><a href="ml.html#linear-regression"><i class="fa fa-check"></i><b>11.6</b> Linear regression</a></li>
<li class="chapter" data-level="11.7" data-path="ml.html"><a href="ml.html#random-forest"><i class="fa fa-check"></i><b>11.7</b> Random forest</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="ml.html"><a href="ml.html#tuning-the-forest"><i class="fa fa-check"></i><b>11.7.1</b> Tuning the forest</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="ml.html"><a href="ml.html#last-fit"><i class="fa fa-check"></i><b>11.8</b> Last fit</a></li>
<li class="chapter" data-level="11.9" data-path="ml.html"><a href="ml.html#going-forward"><i class="fa fa-check"></i><b>11.9</b> Going forward</a></li>
<li class="chapter" data-level="11.10" data-path="ml.html"><a href="ml.html#further-resources-3"><i class="fa fa-check"></i><b>11.10</b> Further resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pm-a.html"><a href="pm-a.html"><i class="fa fa-check"></i><b>12</b> Prediction &amp; Machine Learning - Exercise</a>
<ul>
<li class="chapter" data-level="12.1" data-path="pm-a.html"><a href="pm-a.html#prediction-machine-learning---exercise"><i class="fa fa-check"></i><b>12.1</b> Prediction &amp; Machine Learning - Exercise</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="log-est.html"><a href="log-est.html"><i class="fa fa-check"></i><b>13</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="13.1" data-path="log-est.html"><a href="log-est.html#objectives-8"><i class="fa fa-check"></i><b>13.1</b> Objectives</a></li>
<li class="chapter" data-level="13.2" data-path="log-est.html"><a href="log-est.html#functions-covered-in-this-week"><i class="fa fa-check"></i><b>13.2</b> Functions covered in this week</a></li>
<li class="chapter" data-level="13.3" data-path="log-est.html"><a href="log-est.html#basic-concepts"><i class="fa fa-check"></i><b>13.3</b> Basic concepts</a></li>
<li class="chapter" data-level="13.4" data-path="log-est.html"><a href="log-est.html#application"><i class="fa fa-check"></i><b>13.4</b> Application</a></li>
<li class="chapter" data-level="13.5" data-path="log-est.html"><a href="log-est.html#interpretation-2"><i class="fa fa-check"></i><b>13.5</b> Interpretation</a></li>
<li class="chapter" data-level="13.6" data-path="log-est.html"><a href="log-est.html#model-fit-1"><i class="fa fa-check"></i><b>13.6</b> Model fit</a></li>
<li class="chapter" data-level="13.7" data-path="log-est.html"><a href="log-est.html#diagnostics"><i class="fa fa-check"></i><b>13.7</b> Diagnostics</a></li>
<li class="chapter" data-level="13.8" data-path="log-est.html"><a href="log-est.html#prediction"><i class="fa fa-check"></i><b>13.8</b> Prediction</a></li>
<li class="chapter" data-level="13.9" data-path="log-est.html"><a href="log-est.html#mediation-1"><i class="fa fa-check"></i><b>13.9</b> Mediation</a></li>
<li class="chapter" data-level="13.10" data-path="log-est.html"><a href="log-est.html#comparing-linear-and-logistic-regression"><i class="fa fa-check"></i><b>13.10</b> Comparing linear and logistic regression</a></li>
<li class="chapter" data-level="13.11" data-path="log-est.html"><a href="log-est.html#logistic-regression-in-machine-learning-context"><i class="fa fa-check"></i><b>13.11</b> Logistic regression in Machine Learning context</a></li>
<li class="chapter" data-level="13.12" data-path="log-est.html"><a href="log-est.html#further-resources-4"><i class="fa fa-check"></i><b>13.12</b> Further resources</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis with R for Social Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dags-1" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number"> 4</span> DAGs<a href="dags-1.html#dags-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="objectives-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Objectives<a href="dags-1.html#objectives-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="objectives">
<ul>
<li>Getting to know DAGs</li>
<li>Understand its implications on achieving unbiased estimates for
effects of interest</li>
<li>Building a DAG for the NBA data to model the effect of scored points
on salary</li>
</ul>
</div>
</div>
<div id="functions-covered" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Functions Covered<a href="dags-1.html#functions-covered" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="functions">
<ul>
<li><code>dagitty()</code>: Define Directed Acyclic Graphs.</li>
<li><code>plot()</code>: A generic base R function that can be used to plot a DAG.</li>
<li><code>adjustmentSets()</code>: Derive the adjustment set from a DAG.</li>
</ul>
</div>
</div>
<div id="modelling" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Modelling<a href="dags-1.html#modelling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This session kicks off the block on linear regression as a statistic
modelling technique, but before we jump into the deep end and learn what
linear regression is and how we can apply it, we first have to
understand what modelling is and why we might do it. We also need a way
to find out what we actually have to include in the model and what we
might not want or even can not include to achieve robust results. This
is what this session is all about.</p>
<div id="what-is-modelling" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> What is modelling?<a href="dags-1.html#what-is-modelling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we approach this question, we should briefly think about what
steps a typical data analysis project comprises. We usually start with
an interesting problem and derive a research question from it. Based on
this question we would go into the literature and read up on theories
and already published research papers that are relevant to our question.
We construct a theoretical framework for our particular problem and
formulate some hypotheses, collect or identify appropriate data and
conduct an exploratory data analysis. At this point we should already
have a firm understanding about what we actually want to find out and
how our data is structured. The next step would be modelling.</p>
<p>So what is modelling? In general we have one <em>dependent variable</em>,
typically denoted as <span class="math inline">\(y\)</span>. This variable has some varying values. Our
goal in modelling is to estimate how these values are generated.
Generating here refers to the <em>data generating process</em> that we assume
responsible for <span class="math inline">\(y\)</span> having the values it has. One or multiple
<em>independent variables</em>, <span class="math inline">\(x_1 \ x_2 \ ... \ x_k\)</span>, influence how the
values of <span class="math inline">\(y\)</span> are generated; thus <span class="math inline">\(y\)</span> <em>depends</em> on the values of our
independent variable(s).</p>
<p>When we model, we do not know the data generating process, but based on
theoretical considerations, careful thinking and exploratory data
analysis, we can make assumptions on how we think the process operates.
DAGs are a tool that can assist us in this step. We can use it to
formally clarify our assumptions on the data generating process and to
formulate a model based on its implications.</p>
</div>
<div id="estimating-effects-vs.-prediction" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Estimating effects vs. prediction<a href="dags-1.html#estimating-effects-vs.-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are two main reasons for modelling in the social sciences.</p>
<p>Our goal can be <em>prediction</em>, as in predicting our dependent variable
<span class="math inline">\(y\)</span> with the highest possible accuracy. This maybe is the less classical
approach to modelling, but one that has come to the forefront in recent
years, especially in the context of <em>machine learning</em>.</p>
<p>Take ChatGPT for instance. The underlying GPT model, a large language
model (LLM), is used to predict what the next word in a sequence of
words should be. Based on the context of the question and the prior
words in the answer, which we can understand as independent variables
for our example, it calculates what word has the highest probability of
being the correct next one. It is all about prediction.</p>
<p>An example closer to home are annotations for text data. Imagine you
have a lot of text, hundred thousands of social media posts, and you
want to explore the sentiment expressed in those. Do they lean to the
positive or to the negative? You can now go and take a “small” sample,
let us say a few thousands and annotate them by hand. A lot of work, but
based on those manually annotated posts we can train a machine learning
model that learns from those posts and then, if everything goes well, is
able to automatically annotate the remaining hundred thousands of posts
for us. Again, this is all about prediction; here predicting the
sentiment of a post, the dependent variable, based on the words it
contains, the independent variables.</p>
<p>When prediction is our goal, we most often are not primarily interested
in understanding what independent variables influence the dependent
variables in which direction and with which magnitude. We are interested
in the most accurate prediction for the dependent variable possible.
These approaches are therefore also called <em>y-centered</em>.</p>
<p>When our interest is focused on one or multiple independent variables,
our approach is <em>x-centered</em>. This is the more classical usage of
modelling in statistics, at least for the social sciences. Here our goal
is to estimate an effect of interest as accurately as possible. <span class="math inline">\(y\)</span> is
still our dependent variable but our focus lies on understanding which
<span class="math inline">\(x\)</span> variables influence <span class="math inline">\(y\)</span>, in which direction this influence goes and
what the magnitude of the effect is.</p>
<p>Let us say we are interested in why people cast their vote for a certain
party. We may have some hypotheses that proposes that voters who find
certain issues important have a higher probability of casting their
ballot for this party. Our interest would not be predicting the vote
accurately but explaining why someone votes the way they do. We can
build a model from our assumptions, maybe there are other important
factors that correlate with the issues and the vote, and test our
hypotheses based on the results. Does holding certain issues important
really increase the chances of voting for this party or is there no
effect?</p>
<p>Over the last sessions we build an interest in the relationship between
points scored and the salary received for NBA players. We could approach
this as a prediction problem, i.e. trying to predict the salary as
accurately as possible based on a model that incorporates the scored
points as well as other factors that we assume of having an effect on
the salary. We will return to this in <a href="pm-t.html#pm-t">session 11</a>. We could also
approach this as estimation problem, i.e. trying to estimate the effect
of scored points on the salary. We will most probably have to include
other variables that affect the relationship of score on salary as well,
but the model used will not necessarily be the same. This approach is
what we will tackle in this and the next 5 sessions.</p>
<p>Having settled on estimating the effect of score on salary, how can we
find out which variables we have to include in the model? The first
step, and we can never replace this with ever so fancy a statistical
technique, is thinking about the problem. We should also have a
theoretical understanding of our problem, know the current research on
the topic and do some exploratory data analysis. Based on this we will
already have developed some assumptions concerning our proposed
underlying data generating process. Should we now throw everything into
our model that we deem interesting or relevant for the relationship
between score and salary? No, we should not. What we should do is use a
tool that helps us formalise our assumptions and figure out which
variables are actually relevant for measuring our effect of interest;
and which variables we can not include in our model as they would
potentially lead to incorrect estimations. This is where DAGs come in.</p>
</div>
</div>
<div id="dags" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> DAGs<a href="dags-1.html#dags" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="directed-acyclical-graphs" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Directed acyclical graphs<a href="dags-1.html#directed-acyclical-graphs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>DAG</em> is short for <em>directed acyclical graph</em>. DAGs are <em>graphs</em> that
display the assumed relationship between variables as arrows, or missing
arrows, between them. An arrow represents our assumption that one
variable has an effect on the other, a missing arrow represents our
assumption that one variable has no effect on the other. These arrows
are <em>directed</em>. This represents our assumptions about the direction of
the effect. We do not only assume that two variables are somehow
associated, but we explicitly state which one influences the other.</p>
<p>A simple DAG could look like this:</p>
<p><img src="_main_files/figure-html/dag_directed-1.png" width="672" /></p>
<p>What are the assumptions about the data generating process we have
encoded here? We have one dependent variable <span class="math inline">\(X\)</span> that we assume to have
a direct effect on the independent variable <span class="math inline">\(Y\)</span>. We know that our
assumption was that <span class="math inline">\(X\)</span> has an effect on <span class="math inline">\(Y\)</span> and not the other way
around, because the arrow is <em>directed</em> from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span>.</p>
<p>We call the sequence of one or many arrows that do not pass a single
variable more than once a <em>path</em>. When trying to estimate an effect of
interest we are foremost interested in the paths going from our
independent variable of interest to the dependent variable. In the first
example we only have the one path <span class="math inline">\(X \rightarrow Y\)</span>, but in most “real”
DAGs we will have multiple paths between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>Consider this DAG, where we introduce a second variable <span class="math inline">\(A\)</span>:</p>
<p><img src="_main_files/figure-html/dag_paths-1.png" width="672" /></p>
<p>Here there are two paths from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span>, <span class="math inline">\(X \rightarrow Y\)</span> and
<span class="math inline">\(X \rightarrow A \rightarrow Y\)</span>. Our assumption here was that <span class="math inline">\(X\)</span>
directly influences <span class="math inline">\(Y\)</span>, but that <span class="math inline">\(X\)</span> also directly influences <span class="math inline">\(A\)</span> which
in turn directly influences <span class="math inline">\(Y\)</span>. The latter is an indirect effect from
<span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> through <span class="math inline">\(A\)</span>.</p>
<p>DAGs are also <em>acyclical</em>, meaning that there can not be any cyclical
relationships between variables. A cyclical relationship would be
present if we start from one variable and follow a path that leads us
back to this variable.</p>
<p><img src="_main_files/figure-html/dag_acyclical-1.png" width="672" /></p>
<p>In this example there is a path
<span class="math inline">\(X \rightarrow Y \rightarrow A \rightarrow X\)</span> that leads us from <span class="math inline">\(X\)</span>
back to <span class="math inline">\(X\)</span>. This is not allowed in a DAG.</p>
<p>Now that we know the basics, what do we actually do with a DAG? A DAG is
a way to graphically formalise our assumptions about the data generating
process. But it is about more than drawing nice formalisations, it is
also about figuring out which variables we have to include and which we
are not allowed to include to get an unbiased estimate of our effect of
interest. We do this by <em>blocking</em> all paths from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span> that do not
represent the relationship we want to estimate and at the same time
opening up all paths that do. For this to make sense, we need to know
the three patterns of relationships between a set of three variables and
how we can open or close paths with them.</p>
</div>
<div id="patterns-of-relationships" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Patterns of relationships<a href="dags-1.html#patterns-of-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="chainspipe" class="section level4 hasAnchor" number="4.4.2.1">
<h4><span class="header-section-number">4.4.2.1</span> Chains/Pipe<a href="dags-1.html#chainspipe" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Three variables can be connected in a <em>chain</em> or <em>pipe</em> like this:</p>
<p><img src="_main_files/figure-html/dag_pipe-1.png" width="672" /></p>
<p><span class="math inline">\(X\)</span> has an effect on <span class="math inline">\(A\)</span> which in turn affects the value of <span class="math inline">\(Y\)</span>. This
implies that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are statistically correlated. When the value of
<span class="math inline">\(X\)</span> changes, the value of <span class="math inline">\(Y\)</span> also changes, “transmitted” by the
indirect effect <span class="math inline">\(X\)</span> has on <span class="math inline">\(Y\)</span> through <span class="math inline">\(A\)</span>. Remember we are still
interested in measuring the effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>, so we also want to
measure this indirect effect.</p>
<p>The DAG tells us that there is a relationship between all three
variables. We therefore could be tempted to include <span class="math inline">\(A\)</span> in our model as
well. But what would happen is that by including <span class="math inline">\(A\)</span> we would <em>block</em>
the path between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. We would not be able to measure the
association we are actually interested in. Including such a variable and
thereby blocking a path of interest is called <em>overcontrol bias</em>.</p>
<p>In some cases overcontrolling can make the effect of interest
unmeasurable. We would then conclude from our analysis that <span class="math inline">\(X\)</span> has no
effect on <span class="math inline">\(Y\)</span> and that our hypotheses was wrong, while there actually
could be an effect that we made “disappear” by blocking its path.
Drawing a DAG based on our assumptions helps us to prevent this pitfall.</p>
<div id="mediation" class="section level5 hasAnchor" number="4.4.2.1.1">
<h5><span class="header-section-number">4.4.2.1.1</span> Mediation<a href="dags-1.html#mediation" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>A special case of pipes is <em>mediation</em>.</p>
<p>Consider this DAG:</p>
<p><img src="_main_files/figure-html/dag_mediation-1.png" width="672" /></p>
<p>We see a direct effect through the path <span class="math inline">\(X \rightarrow Y\)</span> as well as
indirect effect through <span class="math inline">\(X \rightarrow A \rightarrow Y\)</span>. Should we
include <span class="math inline">\(A\)</span> in our model? This depends on what we want to measure.</p>
<p>If we are interested in the <em>total effect</em> of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>, we should not.
Both effects, the direct and the indirect paths, are of interest here,
so we keep both paths open by not controlling for <span class="math inline">\(A\)</span>.</p>
<p>Our interest could also lie exclusively in the <em>direct effect</em>. Here we
would want to measure the effect of <span class="math inline">\(X\)</span> stripped by all indirect
effects. In this case we want the path <span class="math inline">\(X \rightarrow Y\)</span> to keep open,
but we would close the path <span class="math inline">\(X \rightarrow A \rightarrow Y\)</span> by
controlling for <span class="math inline">\(A\)</span>.</p>
<p>We could also only be interested in the <em>indirect effect</em>, the effect of
<span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> that goes through <span class="math inline">\(A\)</span>. We can not directly model this, but we
can compute the indirect effect as the difference between total and
direct effect.</p>
</div>
</div>
<div id="confounders" class="section level4 hasAnchor" number="4.4.2.2">
<h4><span class="header-section-number">4.4.2.2</span> Confounders<a href="dags-1.html#confounders" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The second pattern we may see is the <em>fork</em> or <em>confounder</em>.</p>
<p><img src="_main_files/figure-html/dag_confounder-1.png" width="672" /></p>
<p>We see that there is no implied direct relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>
but that both variables are influenced by <span class="math inline">\(A\)</span>. If we would measure the
relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> we <em>should</em> see no statistical
correlation. The problem is, that we <em>would</em> see a correlation despite
this. Why is that? The values of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> both depend on the value of
<span class="math inline">\(A\)</span>. If we for example assume that both effects are positive the value
of <span class="math inline">\(X\)</span> would rise with the value of <span class="math inline">\(A\)</span> and the value of <span class="math inline">\(Y\)</span> would rise
with the value of <span class="math inline">\(A\)</span> also. The opposite would be true if both effects
were negative. Lower values for <span class="math inline">\(A\)</span> would lead to lower values for <span class="math inline">\(X\)</span>
and <span class="math inline">\(Y\)</span>. But even if the effects would be opposite, they would never
cancel each other out perfectly. <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> vary together. If we just
include <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> in our model this would show up as an effect from
<span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>.</p>
<p>In DAG terms, there is an open path between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> although we did
not draw a direct path: <span class="math inline">\(X \leftarrow A \rightarrow Y\)</span>. This may seem
counterintuitive at first, as the arrows go in opposite directions, but
for paths in a DAG to exist, the direction of the arrows does not
matter. Every connection between variables is a path. So there is an
open path, in this case a so called <em>backdoor path</em>, that leads to a
statistical association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, but we can close it by
controlling for <span class="math inline">\(A\)</span>. If we do this, we would see no remaining
association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> and thus get an unbiased estimate for
the effect of interest, i.e. no effect.</p>
<p>If this still seems unintuitive consider the following example, which
you can also find in many statistical textbooks. Do storks bring babies?
We could tackle this analytically by taking a measure of babies born in
a region as our dependent variable and the number of storksightings in
the same region as our dependent variable. Let statistics come to the
rescue and help us discard the notion of the baby bringing stork once
and for all. But alas, our model will tell us that there is a positive
effect from storksightings on the number of newborns. Should we conclude
that everything we learned from our parents and teachers was one big lie
to hide away the magical truth about reproduction? Before we do that,
let us return to rationality. Maybe we have missed something important.
It turns out that there is a confounder we did not include in our model.
More rural areas have higher birthrates and also have a higher rate of
storksightings while both variables have lower values in more urban
regions. Our dependent and independent variables both vary by the value
of the confounder and thus it seems that there is a correlation where
there actually is none. If we now include a measure for the type of
region, let us say population density, this spurious association
disappears and we can return to normality. Storks do not bring babies
after all.</p>
<p><img src="_main_files/figure-html/dag_storks-1.png" width="672" /></p>
</div>
<div id="colliders" class="section level4 hasAnchor" number="4.4.2.3">
<h4><span class="header-section-number">4.4.2.3</span> Colliders<a href="dags-1.html#colliders" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The last pattern we have to consider are <em>colliders</em>. A collider is a
variable on a path that has two arrows pointing into it:</p>
<p><img src="_main_files/figure-html/dag_mediation_1-1.png" width="672" /></p>
<p>Here <span class="math inline">\(A\)</span> is influenced by the value of <span class="math inline">\(X\)</span> as well as <span class="math inline">\(Y\)</span>. Again, there
should be no effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> and in this case there is none if we
just include <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> in our model. If we also include <span class="math inline">\(A\)</span> we
introduce an association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> even if there should be
none. This implies that we should not control for colliders because we
would open up a path that creates a spurious association between two
variables that are not related.</p>
</div>
</div>
<div id="adjustment-set" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Adjustment set<a href="dags-1.html#adjustment-set" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we have all the building blocks for identifying which variables we
have to include in our model and which we are not allowed to include. If
we do not follow these rules we may statistically find relationships
where there are none or miss relationships that actually exist. We then
would draw the wrong conclusions for our hypotheses and research
question. We would produce bad science.</p>
<p>If we draw out our DAG and use its implications to identify the correct
<em>adjustment set</em> <span class="math inline">\(Z\)</span> of control variables, we do not fall into this
trap. We only control what we have to, and nothing that we should not.
We thus create the best model to get an unbiased estimate for our effect
of interest; but there is always a caveat and this is a big one. The
model is only correct if our DAG is also correct and we can never know
for certain if it is. We could make wrong assumptions, forget important
relationships, and make all matters of mistakes while building our DAG.
While DAGs are a great tool for identifying the adjustment set, the
technique alone can never replace careful thinking.</p>
</div>
</div>
<div id="nba-dag" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> NBA DAG<a href="dags-1.html#nba-dag" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will now pick up where we left off in session 2 and return to the NBA
data. Equipped with our new tool we can now draw a DAG with the goal of
building a model to estimate the effect of points scored on the salary a
player receives. The assumption is, that the higher the point average,
the higher the salary. This makes intuitive sense as a high scoring
player is more valuable to the team and thus may receive a higher
monetary compensation.</p>
<p>Let us start building a DAG with the information we already have.</p>
<p><img src="_main_files/figure-html/dag_1-1.png" width="672" /></p>
<p>Now we have to think about other factors that could influence the
relationship between points and salary. One variable we already
identified as having an effect on both was the position a player
occupies. The position influences how many points per game a player can
score and we also already saw that centers make more money compared to
point guards. Right now we have no reason to believe that other
positions do not also have an effect on the received salary. Following
this reasoning, position is a confounder for points and salary.</p>
<p><img src="_main_files/figure-html/dag_2-1.png" width="672" /></p>
<p>It is also reasonable that body height influences which position a
player can occupy. Centers have to be big while smaller players tend to
play on other positions. At the same time, height is an advantage if you
want to score in a basketball game. Thus height is a confounder for
points and position.</p>
<p><img src="_main_files/figure-html/dag_3-1.png" width="672" /></p>
<p>Another factor that will have an effect on the salary is the team a
player plays for. More successful teams will be able to pay higher
salaries. The season an observation was recorded in should also
influence the paid salary as we can expect a general inflation of
salaries over time.</p>
<p><img src="_main_files/figure-html/dag_final_0-1.png" width="672" /></p>
<p>This is our final DAG. Does it correctly depict the underlying data
generating process? We do not know for sure, but the DAG correctly
reflects our assumptions at this point. Those may be wrong. Maybe the
data generating process actually works slightly or even completely
different; but to the best of our current knowledge, this is how the
scored points affect the salary a player receives.</p>
<p>We can now inspect what implications the DAG has for our model. To do
this, let us list the paths from our independent to the dependent
variable.</p>
<p><span class="math display">\[A: Points \rightarrow Salary\]</span>
<span class="math display">\[B: Points \leftarrow Position \rightarrow Salary\]</span></p>
<p><span class="math display">\[C: Points \leftarrow Height \rightarrow Position \rightarrow Salary\]</span>
Path A is a direct path from our independent variable to our dependent
variable. We will have to include scored points and salary into our
model, but that is a given.</p>
<p>Paths B &amp; C are both backdoor paths - these are easily spotable by an
arrow pointing into the independent variable - that we have to address
somehow. Let us consider B first. Position is a confounder for points
and salary. Above we already learned how to deal with this, we control
for it. This removes the spurious part of the association between points
and salary introduced by the confounder. Path C also includes a
confounder, namely the body height of a player. Do we also control for
this variable to close path C? No, we do not. If we further examine path
C we will see that it also includes position as a pipe. When we control
for a variable in a pipe, the path gets closed. As we have to include
position to close path B, path C is also already closed.</p>
<p>The two remaining variables, team and season, have direct effects on the
salary but do not lie on a path from points to salary. This implies,
that we do <strong>not</strong> have to control for them if our goal is estimating
the effect of points on salary.</p>
<p>Above we briefly talked about the two possible goals of modelling. Here
and over the next sessions our goal is estimating an effect of interest
without bias. We used the DAG to identify an adjustment set of variables
we have to control for to reach this goal. If our goal was predicting
the salary as accurately as possible we would made other conclusions.
The team a player is employed by and the season where an observation was
measured are both relevant predictors for the received salary. For
prediction we would have included both variables because this should
increase the accuracy of the prediction. We will return to this in more
detail in <a href="pm-t.html#pm-t">session 11</a>.</p>
</div>
<div id="resources" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Resources<a href="dags-1.html#resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="dagitty.net" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> dagitty.net<a href="dags-1.html#dagitty.net" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While the underlying rules of DAGs are relatively straightforward,
identifying the adjustment set can get harder the more complex a DAG
gets. Consider this for instance:</p>
<p><img src="_main_files/figure-html/dag_final_1-1.png" width="672" /></p>
<p>What variables do we have to include in our adjustment set to get
unbiased measure for the effect from <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>? We would suggest you
take out pen and paper and try to figure it out. You can approach this
as above. List all paths from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span> that do not include a variable
twice and try to find the adjustment set that closes all paths besides
the one(s) needed to measure the effect from <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>. Spoiler: In
this case the only path we want to keep open is the direct effect
<span class="math inline">\(X \rightarrow Y\)</span>.</p>
<p>While this is doable, you may be unsure if you found the correct set.
Luckily there is a convenient way to find out. <a href="https://dagitty.net/" class="uri">https://dagitty.net/</a>
provides a browser tool where you can draw DAGs - as well as export them
for your papers - and check for the correct adjustment set. After
launching the tool you should click on “Model” and then “New model”. Now
you can start drawing. New variables are added by clicking on the canvas
and naming them, arrows are added by first clicking on the variable
where the arrow should start and then on the variable where it should
end. For everything to work you should also declare the independent
variable of interest the “Exposure” and the dependent variable the
“Outcome”. Both can be set on the left under “Variable”. When the DAG is
drawn correctly, the top right panel “Causal effect identification”
should show which variables need to be part of the adjustment set to
estimate the effect of interest.</p>
<p>Note that “Causal effect identification” is set to display the
adjustment set for the total effect. This also is what we are interested
in here. If we are interested in mediation, we can also set the panel to
display the set for the direct effect.</p>
</div>
<div id="how-to-use-dagitty" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> How to use dagitty()<a href="dags-1.html#how-to-use-dagitty" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can also draw DAGs directly in R, using the <code>dagitty</code> package. To
start drawing a DAG we write <code>dagitty('dag {})</code>. The actual definition
of the DAG takes place between the squirly brackets. First we list all
variables in the model by writing their names between quotation marks.
For each variable we can optionally add additional options between
square brackets following the name. In the example below we define one
variable as <code>exposure</code> and one as <code>outcome</code>, just like we would do on
dagitty.net. We also give values for the relative positions. If we skip
those, <code>dagitty()</code> will decide on the positions itself which may or may
not look nice and tidy. After all variables are defined we write out the
paths that should be present connecting the variable names with <code>&lt;-</code> or
<code>-&gt;</code>, depending on the direction an arrow should point. We can than use
<code>plot()</code> to see the DAG.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="dags-1.html#cb61-1" tabindex="-1"></a><span class="co"># Load the dagitty package</span></span>
<span id="cb61-2"><a href="dags-1.html#cb61-2" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb61-3"><a href="dags-1.html#cb61-3" tabindex="-1"></a></span>
<span id="cb61-4"><a href="dags-1.html#cb61-4" tabindex="-1"></a><span class="co"># Define a DAG</span></span>
<span id="cb61-5"><a href="dags-1.html#cb61-5" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">&#39;dag {</span></span>
<span id="cb61-6"><a href="dags-1.html#cb61-6" tabindex="-1"></a><span class="st">  &quot;Exposure&quot; [exposure, pos=&quot;-1,0&quot;]</span></span>
<span id="cb61-7"><a href="dags-1.html#cb61-7" tabindex="-1"></a><span class="st">  &quot;Outcome&quot; [outcome, pos=&quot;1,0&quot;]</span></span>
<span id="cb61-8"><a href="dags-1.html#cb61-8" tabindex="-1"></a><span class="st">  &quot;Confounding Variable&quot; [pos=&quot;0,-1&quot;] </span></span>
<span id="cb61-9"><a href="dags-1.html#cb61-9" tabindex="-1"></a><span class="st">  &quot;Mediator&quot; [pos=&quot;0,1&quot;]</span></span>
<span id="cb61-10"><a href="dags-1.html#cb61-10" tabindex="-1"></a><span class="st">  &quot;Exposure&quot; -&gt; &quot;Outcome&quot;</span></span>
<span id="cb61-11"><a href="dags-1.html#cb61-11" tabindex="-1"></a><span class="st">  &quot;Exposure&quot; -&gt; &quot;Mediator&quot; -&gt; &quot;Outcome&quot;</span></span>
<span id="cb61-12"><a href="dags-1.html#cb61-12" tabindex="-1"></a><span class="st">  &quot;Exposure&quot; &lt;- &quot;Confounding Variable&quot; -&gt; &quot;Outcome&quot;</span></span>
<span id="cb61-13"><a href="dags-1.html#cb61-13" tabindex="-1"></a><span class="st">}&#39;</span> )</span>
<span id="cb61-14"><a href="dags-1.html#cb61-14" tabindex="-1"></a></span>
<span id="cb61-15"><a href="dags-1.html#cb61-15" tabindex="-1"></a><span class="co"># Plot the DAG</span></span>
<span id="cb61-16"><a href="dags-1.html#cb61-16" tabindex="-1"></a><span class="fu">plot</span>(dag)</span></code></pre></div>
<p><img src="_main_files/figure-html/dagitty_example-1.png" width="672" /></p>
<p>We can also use the function <code>adjustmentSets()</code> to derive our adjustment
set. The argument <code>effect =</code> lets us control if we want to see the
adjustment set for the <code>"total"</code> or <code>"direct"</code> effect.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="dags-1.html#cb62-1" tabindex="-1"></a><span class="co"># Identify the minimal adjustment set for estimating the total effect of Exposure on Outcome</span></span>
<span id="cb62-2"><a href="dags-1.html#cb62-2" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag, <span class="at">effect =</span> <span class="st">&quot;total&quot;</span>)</span></code></pre></div>
<pre><code>## { Confounding Variable }</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="dags-1.html#cb64-1" tabindex="-1"></a><span class="co"># Identify the minimal adjustment set for estimating the direct effect of Exposure on Outcome</span></span>
<span id="cb64-2"><a href="dags-1.html#cb64-2" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag, <span class="at">effect =</span> <span class="st">&quot;direct&quot;</span>)</span></code></pre></div>
<pre><code>## { Confounding Variable, Mediator }</code></pre>
</div>
<div id="more-on-dags" class="section level3 hasAnchor" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> More on DAGs<a href="dags-1.html#more-on-dags" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="resources">
<p>If you are interested in diving deeper into DAGs, we can recommend this
resources, which were also used for writing this session.</p>
<p>Richard McElreath provides a great introduction into the topic with many
clear examples. While the book chapter on DAGs may require some
knowledge of advanced statistical topics, the corresponding lecture on
YouTube is more approachable:</p>
<p>McElreath, Richard (2020). Statistical Rethinking: A Bayesian Course
with Examples in R and STAN. Second Edition. Boca Raton &amp; Oxon: CRC
Press. Chapter 5: The Many Variables &amp; The Spurious Waffles, 123-160.</p>
<p>Corresponding YouTube lecture:
<a href="https://www.youtube.com/watch?v=mBEA7PKDmiY" class="uri">https://www.youtube.com/watch?v=mBEA7PKDmiY</a></p>
<p><br />
</p>
<p>Felix Elwert wrote a concise paper on DAGs with a perspective that is
more focused on causality than we have presented here:</p>
<p>Elwert, Felix (2013). Graphical Causal Models. In S. L. Morgan (Hrsg.),
Handbook of Causal Analysis for Social Research, 245–273. Dordrecht
[u.a.]: Springer.</p>
<p><br />
</p>
<p>If you really want to get into it, the work of Judea Pearl was central
for establishing DAGs. An approachable starting point would be the “Book
of Why”:</p>
<p>Pearl, Judea &amp; Dana Mackenzie (2018). The book of why : the new science
of cause and effect. New York: Basic Books.</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="eda-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lin-t-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-DAGs.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
